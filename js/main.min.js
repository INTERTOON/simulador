var JSONData=null;var totalImagesToLoad=null;var totalImagesLoaded=0;var globalImagesArray=null;var imageBaseUrl="";var currentAmbiente=0;var currentSurface=0;
var currentTile=0;var mainStage=null;var mainImage=null;var layers=null;var tileListStatus=false;var maskPlaceholder_id;var ambiente;var totalAmbImagesToLoad=null;
var totalAmbImagesLoaded=0;var selectedShapeTiles=null;var appliedTiles=null;var selectedAmbiente=0;var ambData=null;var u=null;var re="";var swipe=false;
var element=null;var animate=0;function AmbienteObject(c,f,b,a,d,e){this.surfaces=a;this.thumb=f;this.image=b;this.title=e;this.index=c;this.totalImages=d;
this.loadedImages=0;}AmbienteObject.prototype.init=function(){};function ShapeObject(c,b,a){this.shape=b;this.index=c;this.tiles=a;}ShapeObject.prototype.init=function(){};
function ConfigObject(b,d,a,c){this.index=b;this.thumb=d;this.image=a;this.title=c;}ConfigObject.prototype.init=function(){};function CategoriasObject(b,d,a,c){this.index=b;
this.nombre=d;this.image=a;this.title=c;}CategoriasObject.prototype.init=function(){};function menusize(){$(".hscroll2").css({"margin-bottom":"-262px"});
if($(".hscroll2").width()<$(window).width()){var a=$(".hscroll2").find("ol").width();$(".hscroll2").css({left:"50%","margin-left":"-"+parseInt(a*0.5)+"px"});
}$("#ambs").data("mobileIscrollview").refresh();}$(function(){$(document).ready(function(){init();});});function parseJSONData(e){var d=0;var a=e.length;
JSONData=e;var f="";for(var b=0;b<a;b++){var c="";c+="<li>";c+='<a href="#ambiente-detalhe?ambiente='+b+'" class="ambiente" data-transition="slide" data-amb="'+b+'">';
c+="<h1>"+JSONData[b]["title"]+"</h1>";c+='<img class="loading" alt="loading" src="img/ajax-loader.gif" />';c+='<img alt="ambiente1" src="'+JSONData[b]["image"]+'" />';
c+="</a>";c+="</li>";f+=c;}$("#index #ambs ol").html(f);$("#index").page();menusize();prepareAppLoading();}function updateAppliedTiles(){$("#applied-tiles").html("");
for(var a=0;a<appliedTiles.length;a++){var b="";b+="<li>";b+="<img src='"+appliedTiles[a].image.src+"' class='peca'/>";b+="<p>"+appliedTiles[a].title+"</p>";
b+="</li>";$("#applied-tiles").append(b);}}function updateAppliedTiles2(a){$("#applied-tiles").html("");for(var b=0;b<appliedTiles[a].title.length;b++){var c="";
c+="<li>";console.log(appliedTiles[b]);console.log(appliedTiles[a]);console.log(appliedTiles[a].title[b]);c+="<img src='"+appliedTiles[a].title[b].tileImagedefaultImage.src+"' class='peca'/>";
c+="<p>"+appliedTiles[a].title[b].title+"</p>";c+="</li>";$("#applied-tiles").append(c);}}function updateLoadingImages(){totalImagesLoaded++;$("#loading h1").text("carregando..."+parseFloat((totalImagesLoaded*100)/totalImagesToLoad).toFixed(1)+"%");
if(totalImagesLoaded==totalImagesToLoad){$("#loading").fadeOut(400);menusize();}}function prepareImageToLoad(a){var b=new Image();b.onload=updateLoadingImages;
b.src=a;if(b.complete){updateLoadingImages();}return b;}function prepareImageToLoadAmb(a){var b=new Image();b.onload=updateLoadedImages;b.src=a;if(b.complete){updateLoadedImages();
}return b;}function updateLoadedImages(){globalImagesArray[currentAmbiente].loadedImages++;$("#percent p").text("carregando..."+parseFloat((globalImagesArray[currentAmbiente].loadedImages*100)/globalImagesArray[currentAmbiente].totalImages).toFixed(1)+"%");
if(globalImagesArray[currentAmbiente].loadedImages==globalImagesArray[currentAmbiente].totalImages){$("a.ambiente img.loading").hide();$("#block").hide();
$("#percent").hide();$("#percent p").text("cargando...");showAmbiente(u,ambData.options);}}function prepareAppLoading(){prepareDataForLoading();var b=globalImagesArray.length;
console.log(globalImagesArray);for(var a=0;a<b;a++){globalImagesArray[a].thumb=prepareImageToLoad(globalImagesArray[a].thumb);globalImagesArray[a].image=prepareImageToLoad(globalImagesArray[a].image);
globalImagesArray[a].loadedImages+=2;}}function prepareAmbLoading(){$("#percent").show();var g=globalImagesArray.length;var f=globalImagesArray[currentAmbiente].surfaces.length;
for(var e=0;e<f;e++){globalImagesArray[currentAmbiente].surfaces[e].shape=prepareImageToLoadAmb(globalImagesArray[currentAmbiente].surfaces[e].shape);var c=globalImagesArray[currentAmbiente].surfaces[e].tiles.length;
for(var d=0;d<c;d++){globalImagesArray[currentAmbiente].surfaces[e].tiles[d].image=prepareImageToLoadAmb(globalImagesArray[currentAmbiente].surfaces[e].tiles[d].image);
var b=globalImagesArray[currentAmbiente].surfaces[e].tiles[d].title.length;for(var a=0;a<b;a++){globalImagesArray[currentAmbiente].surfaces[e].tiles[d].title[a].tileImage=prepareImageToLoadAmb(globalImagesArray[currentAmbiente].surfaces[e].tiles[d].title[a].tileImage);
globalImagesArray[currentAmbiente].surfaces[e].tiles[d].title[a].tileImagedefaultImage=prepareImageToLoadAmb(globalImagesArray[currentAmbiente].surfaces[e].tiles[d].title[a].defaultImage);
}}}}function prepareDataForLoading(){globalImagesArray=new Array();var d=JSONData.length;for(var l=0;l<d;l++){var e=0;var f=JSONData[l].surfaces.length;
var a=new Array();for(var h=0;h<f;h++){var o=JSONData[l].surfaces[h].categories.length;var n=new Array();console.log(JSONData[l]);for(var c=0;c<o;c++){n.push(new CategoriasObject(c,JSONData[l].surfaces[h].categories[c].nombre,JSONData[l].surfaces[h].categories[c].image,JSONData[l].surfaces[h].categories[c].tiles));
e+=c+1;var b=JSONData[l].surfaces[h].categories[c].tiles.length;var p=new Array();for(var g=0;g<b;g++){p.push(new ConfigObject(g,JSONData[l].surfaces[h].categories[c].tiles[g].tileImage,JSONData[l].surfaces[h].categories[c].tiles[g].defaultImage,JSONData[l].surfaces[h].categories[c].tiles[g].title));
e+=g+1;}}a.push(new ShapeObject(h,JSONData[l].surfaces[h].shape,n));e++;}totalImagesToLoad+=2;e+=2;globalImagesArray.push(new AmbienteObject(l,JSONData[l].image,JSONData[l].imageBig,a,e,JSONData[l].title));
}}function init(){$.ajax({type:"GET",url:"js/data.json",dataType:"json",success:parseJSONData});$(document).bind("pagebeforechange",function(c,b){ambData=b;
if(typeof b.toPage==="string"){u=$.mobile.path.parseUrl(b.toPage);re=/^#ambiente-detalhe/;if(u.hash.search(re)!==-1){currentAmbiente=parseInt(u.hash.replace(/.*ambiente=/,""));
if(swipe){c.preventDefault();return false;}if(globalImagesArray[currentAmbiente]!==undefined){if(globalImagesArray[currentAmbiente].totalImages>globalImagesArray[currentAmbiente].loadedImages){console.log("Cargando");
$("a.ambiente").each(function(){if($(this).data("amb")==currentAmbiente){$(this).find("img.loading").show();}else{$(this).find("img.loading").hide();}});
$("#block").show();prepareAmbLoading();}else{console.log(u);console.log(b);console.log(b.options);showAmbiente(u,b.options);}c.preventDefault();}else{window.history.back();
}}else{if(u.hash=="#index"){closeProducts();$("body").delay(800).fadeIn(1000,function(){$("#ambiente-detalhe #content div.amb").html("");$("#ambiente-detalhe div.footer ol").html("");
});}}}});$("body").mousedown(function(b){element=b.target;}).mouseup(function(b){if((element==b.target)&&swipe){b.preventDefault();swipe=false;}}).bind("MSPointerMove");
$("body").on("touchstart",function(b){element=b.target;});$("body").on("touchend",function(b){if((element==b.target)&&swipe){b.preventDefault();swipe=false;
}}).on("swipeleft",function(b){swipe=true;}).on("MSPointerMove",function(b){swipe=true;});$("body").on("swiperight",function(b){swipe=true;});$("#landing").on("touchend",function(b){$(this).fadeOut(500);
});$("#landing").click(function(b){$(this).fadeOut(500);});$("a.fechar").click(function(b){b.preventDefault();$("#emaill").fadeOut(500);return false;});
$("#ajuda").click(function(b){b.preventDefault();$("#landing").fadeIn(500);return false;});$("#materiais").click(function(b){b.preventDefault();if(!$(this).hasClass("active")){$(this).addClass("active");
$("#applied-tiles").fadeIn(500);}else{$(this).removeClass("active");$("#applied-tiles").fadeOut(500);}return false;});$("#ajuda").on("touchend",function(b){$("#landing").fadeIn(500);
});$("#guardar").click(function(){mainStage.toDataURL({callback:function(b){console.log("dataURL");$("#emaill img.email").attr("src",b);$("#formEmail #image").val(b);
imageData=b;$("#emaill").fadeIn(500);}});console.log("here");});$("#right").click(function(){$("#tiles").iscrollview("scrollTo",100,0,100,true);console.log("right");
});$("#left").click(function(){$("#tiles").iscrollview("scrollTo",-100,0,100,true);console.log("left");});$("a.setaScroll").click(function(b){b.preventDefault();
$("#ambs").iscrollview("scrollTo",500,0,100,true);console.log("right yo");return false;});$("a.setaScrollLeft").click(function(b){b.preventDefault();$("#ambs").iscrollview("scrollTo",-500,0,100,true);
console.log("left yo");return false;});var a=true;$("#formEmail").submit(function(g){g.preventDefault();if(a){$("#block").show();var d=true;if(($("#formEmail #email").val()=="")||($("#formEmail #email").val().search("@")==-1)||($("#formEmail #email").val().search("[*.]")==-1)){d=false;
}if(d){a=false;var c="";for(var b=0;b<appliedTiles.length;b++){c+=appliedTiles[b].image.src+"==="+appliedTiles[b].title;if(b!=(appliedTiles.length-1)){c+=";;";
}}var h="actions.php";var f={email:$("#formEmail #email").val(),image:imageData,apl:c};console.log(h);$.ajax({url:h,dataType:"html",type:"POST",data:f,async:true});
$("#emaill").fadeOut(500);$("#formEmail #email").val("");$("#block").hide();a=true;}else{}return false;}});}function buildStage(){var b=parseSize(JSONData[currentAmbiente].imageBigSize);
var a={height:0,width:0};a.height=$(window).height();a.width=(b.width*a.height)/b.height;mainStage=new Kinetic.Stage({container:"mainStage",width:a.width,height:a.height});
configStage();}function configStage(){$("#download").click(saveImage);$("div.containing").css({width:(mainStage.width())+"px","margin-left":"-"+(mainStage.width()/2)+"px"});
var a='<div class="prod_apl">';a+="<h3>Produtos Aplicados:</h3>";a+='<ul id="prod_apl">';a+="</ul>";a+="</div>";$("div.containing").append(a);$(".amb").panzoom({minScale:1,increment:0.5,maxScale:10,contain:"invert"});
$(".amb").panzoom("reset");var b=1;$(".amb").on("panzoomend",function(f,d,c,g){if(g){if(c[0]==1){$(this).panzoom("resetPan");}}else{}});$("div.ambiente").on("mousewheel",function(d){if(d.deltaY>0){$(this).find(".amb").panzoom("zoom");
}else{$(this).find(".amb").panzoom("zoom",true);}var c=$(this).find(".amb").panzoom("getMatrix");c[4]=0;c[5]=0;if(c[0]==1){console.log("here");$(this).find(".amb").panzoom("reset");
}});$("div.footer h1").click(closeProducts).bind("touchend");}function prepareImageToStage(a,c,b,d){var e={x:0,y:0,width:mainStage.width(),height:mainStage.height()};
if(c!=null){e=c;}if(b!=null){e.height=(c.height*mainStage.height())/b.height;e.width=(c.width*mainStage.width())/b.width;e.x=(c.x*mainStage.width())/b.width;
e.y=(c.y*mainStage.height())/b.height;}if(d){return new Kinetic.Image({image:a,x:e.x,y:e.y,width:e.width,height:e.height,opacity:0,blurRadius:40});}else{return new Kinetic.Image({image:a,x:e.x,y:e.y,width:e.width,height:e.height});
}}function closeProducts(){if(tileListStatus){currentSurface=-1;tileListStatus=false;TweenLite.to($("#tiles"),0.5,{css:{height:0},ease:Expo.easeOut});$("img.seta").fadeOut(500);
$("#right").fadeOut(500);$("#left").fadeOut(500);return false;}}function shapeClicked(){if(!swipe){if(currentSurface!=this._index){if(tileListStatus){tileListStatus=false;
var a=this._index;TweenLite.to($("#tiles"),0.5,{css:{height:0},ease:Expo.easeOut,onComplete:categories,onCompleteParams:[this._index]});return false;}categories(this._index);
}}}function shapeOver(){var a=this._index;layers[4].children[a].play();$("#mainStage").css("cursor","pointer");}function shapeOut(){var a=this._index;layers[4].children[a].reverse();
$("#mainStage").css("cursor","default");}function categories(d){currentSurface=d;var g=globalImagesArray[currentAmbiente].surfaces[currentSurface].tiles.length;
$("#tileList").html("");$("#tiles").css("display","block");$("#tilesx").css("display","none");var b=0;var c=0;for(var f=0;f<g;f++){var e="<li><a class='subcat' onclick='detail_arr("+f+","+currentSurface+")' data-peca='"+f+"' href='#'>";
e+="<input type='hidden' name='cat' class='id_cat' value='"+f+"'>";e+="<img src='"+globalImagesArray[currentAmbiente].surfaces[currentSurface].tiles[f].image.src+"' class='pecax'/></a><p>";
e+=globalImagesArray[currentAmbiente].surfaces[currentSurface].tiles[f].nombre+"</p>";e+="</li>";$("#tileList").append(e);b=null;c=null;}$("#tiles").data("mobileIscrollview").refresh();
TweenLite.to($("#tiles"),0.5,{height:175,ease:Expo.easeOut});$("#tiles").iscrollview("scrollToElement","a.peca:first-child");$("#right").fadeIn(500);$("#left").fadeIn(500);
$("img.seta").fadeIn(500,function(){$("#tiles").iscrollview("scrollToElement","a.active");});tileListStatus=true;}function detail_arr(f,g){var e=globalImagesArray[currentAmbiente].surfaces[g].tiles[f].title.length;
$("#tileListx").html("");$("#tiles").css("display","none");$("#tilesx").css("display","block");var c=0;var d=0;for(var b=0;b<e;b++){if(selectedShapeTiles[g]==b){$("#tileListx").append("<li><a class='pecax active' onclick='tileClicked("+f+","+b+")' data-pecax='"+f+"' href='#'><img src='"+globalImagesArray[currentAmbiente].surfaces[g].tiles[f].title[b].tileImage.src+"' class='pecax'/></a><p>"+globalImagesArray[currentAmbiente].surfaces[g].tiles[f].title[b].title+"</p></li>");
}else{$("#tileListx").append("<li><a class='pecax' data-pecax='"+f+"' href='#'><img src='"+globalImagesArray[currentAmbiente].surfaces[g].tiles[f].title[b].tileImage.src+"' class='pecax'/></a><p>"+globalImagesArray[currentAmbiente].surfaces[g].tiles[f].title[b].title+"</p></li>");
}c=null;d=null;}$("#tilesx").data("mobileIscrollview").refresh();TweenLite.to($("#tilesx"),0.5,{height:175,ease:Expo.easeOut});$("#tilesx").iscrollview("scrollToElement","a.pecax:first-child");
$("#right").fadeIn(500);$("#left").fadeIn(500);$("img.seta").fadeIn(500,function(){$("#tilesx").iscrollview("scrollToElement","a.active");});tileListStatus=true;
}function tileClicked(c,a){if(!swipe){$("a.pecax").removeClass("active");$(this).addClass("active");var d=parseInt($(this).data("pecax"));currentTile=c;
currentTileRecurrent=a;layers[2].children[currentSurface].destroy();console.log(layers);console.log(currentSurface);console.log(currentTile);console.log(globalImagesArray[currentAmbiente].surfaces[currentSurface].tiles);
console.log(globalImagesArray[currentAmbiente].surfaces[currentSurface].tiles[currentTile].image);layers[2].children[currentSurface]=prepareImageToStage(globalImagesArray[currentAmbiente].surfaces[currentSurface].tiles[currentTile].title[currentTileRecurrent].defaultImage,parseSize(JSONData[currentAmbiente].surfaces[currentSurface].size),parseSize(JSONData[currentAmbiente].imageBigSize));
layers[2].children[currentSurface].listening(false);layers[2].layer.add(layers[2].children[currentSurface]);layers[2].layer.draw();selectedShapeTiles[currentSurface]=currentTile;
for(var b=0;b<appliedTiles[currentTile].title.length;b++){if(appliedTiles[b].index==currentSurface){appliedTiles[b].image=globalImagesArray[currentAmbiente].surfaces[currentSurface].tiles[currentTile].tileImagedefaultImage,appliedTiles[b].title=globalImagesArray[currentAmbiente].surfaces[currentSurface].tiles[currentTile].title;
}}}}function buildTileList(e){console.log("Open Shape");currentSurface=e;var h=globalImagesArray[currentAmbiente].surfaces[currentSurface].tiles.length;
$("#tileList").html("");$("#tiles").css("display","block");var c=0;var d=0;for(var g=0;g<h;g++){var f=globalImagesArray[currentAmbiente].surfaces[currentSurface].tiles[g].title.length;
for(var b=0;b<f;b++){if(selectedShapeTiles[currentSurface]==b){$("#tileList").append("<li><a class='peca active' data-peca='"+g+"' href='#'><img src='"+globalImagesArray[currentAmbiente].surfaces[currentSurface].tiles[g].title[b].tileImage.src+"' class='peca'/></a><p>"+globalImagesArray[currentAmbiente].surfaces[currentSurface].tiles[g].title[b].title+"</p></li>");
}else{$("#tileList").append("<li><a class='peca' data-peca='"+g+"' href='#'><img src='"+globalImagesArray[currentAmbiente].surfaces[currentSurface].tiles[g].title[b].tileImage.src+"' class='peca'/></a><p>"+globalImagesArray[currentAmbiente].surfaces[currentSurface].tiles[g].title[b].title+"</p></li>");
}c=null;d=null;}}$("a.peca").on("click",tileClicked);$("#tiles").data("mobileIscrollview").refresh();TweenLite.to($("#tiles"),0.5,{height:175,ease:Expo.easeOut});
$("#tiles").iscrollview("scrollToElement","a.peca:first-child");$("#right").fadeIn(500);$("#left").fadeIn(500);$("img.seta").fadeIn(500,function(){$("#tiles").iscrollview("scrollToElement","a.active");
});tileListStatus=true;}function saveImage(a){return false;}function showAmbiente(b,k){selectedShapeTiles=new Array();layers=new Array();appliedTiles=new Array();
var h=b.hash.replace(/\?.*$/,"");var f=$(h);buildStage();currentSurface=-1;layers.push({layer:new Kinetic.Layer(),children:new Array()});$("h1.amb-title").text("");
$("h1.amb-title").text(globalImagesArray[currentAmbiente].title);layers[0].children.push(prepareImageToStage(globalImagesArray[currentAmbiente].image,null,null));
layers[0].layer.add(layers[0].children[0]);var g=globalImagesArray[currentAmbiente].surfaces.length;layers.push({layer:new Kinetic.Layer(),children:new Array()});
layers.push({layer:new Kinetic.Layer(),children:new Array()});layers.push({layer:new Kinetic.Layer(),children:new Array()});layers.push({layer:new Kinetic.Layer(),children:new Array()});
$("#tiles").height(0);for(var e=0;e<g;e++){var d=globalImagesArray[currentAmbiente].surfaces[e].tiles.length;layers[1].children.push(prepareImageToStage(globalImagesArray[currentAmbiente].surfaces[e].shape,parseSize(JSONData[currentAmbiente].surfaces[e].size),parseSize(JSONData[currentAmbiente].imageBigSize)));
layers[1].layer.add(layers[1].children[e]);layers[1].children[e].cache();layers[1].children[e]._index=e;layers[1].children[e].drawHitFromCache();layers[1].children[e].on("click",shapeClicked);
layers[1].children[e].on("touchend",shapeClicked);layers[1].children[e].on("mouseover",shapeOver);layers[1].children[e].on("mouseout",shapeOut);selectedShapeTiles.push(0);
layers[2].children.push(prepareImageToStage(globalImagesArray[currentAmbiente].surfaces[e].tiles[0].title[0].tileImagedefaultImage,parseSize(JSONData[currentAmbiente].surfaces[e].size),parseSize(JSONData[currentAmbiente].imageBigSize)));
layers[2].layer.add(layers[2].children[e]);layers[2].children[e].listening(false);appliedTiles.push({index:e,image:globalImagesArray[currentAmbiente].surfaces[e].tiles[0].title[0].tileImagedefaultImage,title:globalImagesArray[currentAmbiente].surfaces[e].tiles[0].title});
layers[3].children.push(prepareImageToStage(globalImagesArray[currentAmbiente].surfaces[e].tiles[0].title[0].tileImagedefaultImage,parseSize(JSONData[currentAmbiente].surfaces[e].size),parseSize(JSONData[currentAmbiente].imageBigSize),true));
layers[3].layer.add(layers[3].children[e]);var j=new Kinetic.Tween({node:layers[3].children[e],duration:0.5,opacity:0.3,easing:Kinetic.Easings.EaseInOut});
layers[3].children[e].listening(false);layers[4].children.push(j);}layers[1].layer.drawHit();for(var e=0;e<layers.length;e++){mainStage.add(layers[e].layer);
}var c=new Kinetic.Layer();var a=new Image();a.onload=function(){var i=new Kinetic.Image({x:20,y:($(window).height()-84),image:a,width:57,height:64});c.add(i);
mainStage.add(c);updateAppliedTiles();f.page();k.dataUrl=b.href;$.mobile.changePage(f,k);};a.src="img/biancogres-small-logo.png";}function parseSize(b){var c=b.split(";");
var a=c.join("=");c=a.split("=");return{x:c[1],y:c[3],width:c[5],height:c[7]};}function placeBackgroundImage(b,a){return"<img class='big' data-name='Back' data-width='"+a.width+"' data-height='"+a.height+"' src='"+b+"' />";
}function placeMaskedTiles(a){var d=a.length;var e=null;for(var c=0;c<d;c++){if(c==0){e=new Array();}var b=parseSize(a[c].size);e.push("<img id='maskedTilePlaceholder-"+a[c].id+"' class='maskedTilePlaceholder' data-width='"+b.width+"' data-height='"+b.height+"' data-x='"+b.x+"' data-y='"+b.y+"' src='"+a[c].tiles[0].defaultImage+"'/>");
}return e;}function placeMasks(a){alert("masks");console.log(a);var d=a.length;var e=null;for(var c=0;c<d;c++){if(c==0){e=new Array();}var b=parseSize(a[c].size);
e.push("<img id='maskPlaceholder-"+a[c].id+"' class='maskPlaceholder' data-mask='"+c+"' data-width='"+b.width+"' data-height='"+b.height+"' data-x='"+b.x+"' data-y='"+b.y+"' src='"+a[c].shape+"'/>");
}return e;}function placeTiles(a){var b=a.length;var g=null;for(var c=0;c<b;c++){if(c==0){g=new Array();}var f=a[c]["id_surface"];var e=a[c]["position"];
var d=a[c]["tileImage"];g.push("<li><a class='peca' data-peca='"+e+"' href='#'><img class='peca' src='"+d+"'/></a></li>");}return g;}function setAmbiente(){var l=false;
var m;var f;var c;var a;var e=1;var k=$("div.ambiente");f=k.find("div.amb img.big").data("width");c=k.find("div.amb img.big").data("height");k.find("div.amb img.maskedTilePlaceholder").each(function(){var p=$(this).data("width");
var n=$(this).data("height");var i=$(this).data("x");var q=$(this).data("y");var o=$(this).data("mask");p=p*100/f;i=i*100/c;q=q*100/f;$(this).css({width:p+"%",height:"auto",left:i+"%",top:q+"%"});
});k.find("div.amb img.maskPlaceholder").each(function(){var p=$(this).data("width");var n=$(this).data("height");var i=$(this).data("x");var q=$(this).data("y");
var o=$(this).data("mask");p=p*100/f;i=i*100/c;q=q*100/f;$(this).css({width:p+"%",height:"auto",left:i+"%",top:q+"%"});});a=$(window).height();var g=$(window).width();
e++;if(Math.ceil(c*g/f)>a){var d=parseInt(Math.ceil(f*a)/c);k.find("div.amb").css({width:d+"px",left:"50%","margin-left":"-"+(d/2)+"px"});}else{k.find("div.amb").css({top:"50%","margin-top":"-"+Math.ceil(c*g/f)/2+"px"});
}var j=$("div.amb").width();var h=$("div.amb").height();var b=$(window).width();var a=$(window).height();}function done(){var k;var j;var g;var b;var d=true;
$("body").mousedown(function(l){e=l.target;}).mouseup(function(l){if((e==l.target)&&f){l.preventDefault();f=false;}}).bind("MSPointerMove");$("*:not(.amb)").click(function(l){if($("html").hasClass("no-touch")){if(f){l.preventDefault();
}}});$("body").on("swipeleft",function(l){f=true;});$("body").on("MSPointerMove",function(l){f=true;});$("body").on("swiperight",function(l){f=true;});
$("#index a").hover(function(l){$("#index a").css({opacity:"0.5"});$(this).css({opacity:"1"});},function(l){$("#index a").css({opacity:"1"});});$("#index a").on("touchstart",function(l){$("#index a").css({opacity:"0.5"});
$(this).css({opacity:"1"});});$("#index a").on("touchend",function(l){$("#index a").css({opacity:"1"});});$("#footer h1").click(function(l){if(j!=""){$("#ambiente-detalhe div.pecas").each(function(){if($(this).data("mask")==j){if($(this).css("display")=="block"){$(this).slideUp("fast");
}else{$(this).slideDown("fast");}}else{$(this).slideUp("fast");}});}}).bind("touchend");var f=false;var e;var a;var c;menusize();a=c/1.5;$(window).resize(menusize);
$(".amb").panzoom({minScale:1,increment:0.5,maxScale:10});$(".amb").panzoom("reset");if($("html").hasClass("no-touch")){$("div.amb").dblclick(function(){if(!zoom){$(this).panzoom("zoom",5,{animate:true});
zoom=true;}else{$(this).panzoom("zoom",1,{animate:true});zoom=false;$(this).panzoom("reset");}});$("div.ambiente").on("mousewheel",function(m){if(m.deltaY>0){$(this).find(".amb").panzoom("zoom");
}else{$(this).find(".amb").panzoom("zoom",true);}var l=$(this).find(".amb").panzoom("getMatrix");l[4]=0;l[5]=0;if(l[0]==1){$(this).find(".amb").panzoom("reset");
}});}var h=true;var i=1;$(".amb").on("panzoomend",function(p,o,l,q){if(q){if(l[0]==1){$(this).panzoom("resetPan");}}else{if($("html").hasClass("touch")){var m=p.target;
var n=$(m).hitTestPoint({x:p.pageX,y:p.pageY,transparency:false});if(!n&&$(m).data("mask")!=undefined&&$(m).hasClass("mask")){maskPlaceholder_id=$(m).data("mask");
$("#ambiente-detalhe div.pecas").each(function(){if($(this).data("mask")==j){$(this).slideDown("fast");}else{$(this).slideUp("fast");}});$("#ambiente-detalhe div.formatos").slideUp("fast");
$("#ambiente-detalhe div.pecas").each(function(){if($(this).data("mask")==j){if($(this).css("display")=="none"){$(this).slideDown("fast");}}});}else{maskPlaceholder_id="";
$("#ambiente-detalhe div.pecas").slideUp("fast");$("#ambiente-detalhe div.formatos").slideUp("fast");}}}});$("div.pecas").slideUp("fast");$("div.formatos").slideUp("fast");
$("body").on("mousemove",function(m){var l=$(m.target).hitTestPoint({x:m.pageX,y:m.pageY,transparency:true});if(l&&$(m.target).data("mask")!=undefined&&$(m.target).hasClass("maskPlaceholder")){$("img.maskPlaceholder").css({opacity:"0",cursor:"default"});
$(m.target).css({opacity:"0.3",cursor:"pointer"});}else{if(!l&&$(m.target).data("mask")!=undefined&&$(m.target).hasClass("maskPlaceholder")){$(m.target).css({opacity:"0",cursor:"default"});
}else{$("img.maskPlaceholder").css({opacity:"0",cursor:"default"});}}});$("div.amb").on("click",function(n){var m=$(n.target).hitTestPoint({x:n.pageX,y:n.pageY,transparency:true});
if(m&&$(n.target).data("mask")!=undefined&&$(n.target).hasClass("maskPlaceholder")){maskPlaceholder_id=$(n.target).data("mask");var l=JSONData[ambiente].surfaces[maskPlaceholder_id].tiles;
l=placeTiles(l).join("");console.log();$("#ambiente-detalhe div.pecas").slideUp("fast",function(){$("#ambiente-detalhe #footer ol").html("");$("#ambiente-detalhe #footer ol").append(l);
$("#ambiente-detalhe div.pecas").data("mobileIscrollview").refresh();$(this).slideDown("fast");});console.log("here");}else{maskPlaceholder_id="";$("#ambiente-detalhe div.pecas").slideUp("fast");
}});$("#ambiente-detalhe div.pecas a.peca").click(function(m){var l=$(this).find("img").attr("src");g=$(this).data("peca");b=$(this).data("formato");if(!$(this).hasClass("active")){$("#ambiente-detalhe div.amb img.p").each(function(){if(($(this).data("mask")==j)&&($(this).data("peca")==g)&&($(this).data("formato")==b)){$(this).css({opacity:1});
}else{if(($(this).data("mask")==j)&&($(this).data("peca")!=g)||($(this).data("formato")!=b)){$(this).css({opacity:0});}}});$("#ambiente-detalhe div.pecas").each(function(){if($(this).data("mask")==j){$(this).find("a.peca").each(function(){if($(this).data("peca")==g){$(this).addClass("active");
}else{$(this).removeClass("active");}});}});}else{$("#ambiente-detalhe div.pecas").each(function(){if($(this).data("mask")==j){$(this).find("a.peca").removeClass("active");
}});$("#ambiente-detalhe div.amb img.p").each(function(){if(($(this).data("mask")==j)&&($(this).data("peca")==g)){$(this).css({opacity:0});}});b="";g="";
}return false;});}